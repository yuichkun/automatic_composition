var fs = require('fs');
var Logger = require('./Logger.js');
const opmoPath = '../Opusmodus';

class Opmo{
  constructor(data){
    this.name = data.name;
    this.content = data.content;
  }

  genBody(){
    var fileName = this.name;
    Logger.genSnippet(fileName);
    var count = Math.floor(Math.random() * 20) + 1;
    var body =
`(setf omn (renda 'd6 '(5e) ${count}))`;

// `(setf omn (make-omn :pitch melo :length (span melo \'(s))))
// `
    return body;
  }

  genFooter(){
    var name = this.name;
    var footer =
`(def-score ${name}
         (:key-signature 'atonal
          :time-signature t-sig
          :tempo 120)
(${name} :omn omn)
)`;
    return footer;
  }

  exportFile(opmo){
    var fileName = this.name;
    var path = opmoPath + '/' + fileName + '.opmo';
    fs.writeFile(path, opmo);
    Logger.showOpmo(opmo, fileName);
    Logger.export(this.name, path);
  }
}

module.exports = Opmo;
